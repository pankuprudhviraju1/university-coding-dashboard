<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeTrack - University Coding Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: white;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2em;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 10px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 15px 30px;
            margin: 0 5px;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: 500;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1em;
        }

        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .dashboard {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .dashboard h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-select {
            padding: 12px 20px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            background: white;
            min-width: 180px;
        }

        .view-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .view-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-color: #ff6b6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }

        .view-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .students-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            display: table;
            width: 100%;
        }

        .table-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            display: table-header-group;
            font-weight: 600;
            text-align: center;
        }

        .table-header div {
            display: table-cell;
            padding: 20px 10px;
        }

        .table-row {
            display: table-row;
            border-bottom: 1px solid #f0f0f0;
            transition: all 0.3s ease;
        }

        .table-row:hover {
            background: #f8f9ff;
            transform: scale(1.01);
        }

        .table-row:last-child {
            border-bottom: none;
        }
        
        .table-cell {
            display: table-cell;
            vertical-align: middle;
            padding: 15px 10px;
            text-align: center;
        }

        .rank-cell {
            font-weight: 700;
            font-size: 1.2em;
        }

        .rank-cell.rank-1 { color: #ffd700; }
        .rank-cell.rank-2 { color: #c0c0c0; }
        .rank-cell.rank-3 { color: #cd7f32; }
        .rank-cell.rank-other { color: #667eea; }

        .name-cell {
            text-align: left;
            padding-left: 20px;
        }

        .name-cell .student-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }

        .name-cell .student-uni {
            font-size: 0.85em;
            color: #666;
        }

        .platform-score {
            background: #f0f4ff;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 600;
            color: #333;
            border-left: 3px solid;
            display: inline-block;
        }

        .platform-score.codechef { border-left-color: #5cb85c; }
        .platform-score.codeforces { border-left-color: #1f8dd6; }
        .platform-score.leetcode { border-left-color: #ff6b35; }

        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .student-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid;
            position: relative;
            overflow: hidden;
        }

        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .student-card.rank-1 { border-left-color: #ffd700; }
        .student-card.rank-2 { border-left-color: #c0c0c0; }
        .student-card.rank-3 { border-left-color: #cd7f32; }
        .student-card.rank-other { border-left-color: #667eea; }

        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .student-name {
            font-size: 1.4em;
            font-weight: 700;
            color: #333;
            margin-bottom: 2px;
        }

        .rank-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .rank-badge.rank-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #333; }
        .rank-badge.rank-2 { background: linear-gradient(135deg, #c0c0c0, #e5e5e5); color: #333; }
        .rank-badge.rank-3 { background: linear-gradient(135deg, #cd7f32, #daa520); color: white; }

        .student-info {
            margin-bottom: 20px;
            color: #666;
        }

        .platforms {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .platform {
            text-align: center;
            padding: 15px 10px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .platform:hover {
            transform: translateY(-2px);
        }

        .platform.codechef {
            background: linear-gradient(135deg, #5cb85c, #449d44);
            color: white;
        }

        .platform.codeforces {
            background: linear-gradient(135deg, #1f8dd6, #1a7bb9);
            color: white;
        }

        .platform.leetcode {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
        }

        .platform h4 {
            margin-bottom: 8px;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .platform .score {
            font-size: 1.3em;
            font-weight: 700;
        }

        .total-score {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.2em;
        }

        .total-score-cell {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-weight: 700;
            margin: 0 5px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
            font-weight: 500;
        }
        
        /* Responsive CSS */
        @media (max-width: 1024px) {
            .table-header, .table-row {
                font-size: 0.9em;
                padding: 10px 5px;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .student-grid {
                grid-template-columns: 1fr;
            }
            
            .platforms {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .stats-overview {
                grid-template-columns: repeat(2, 1fr);
            }

            .table-header, .table-row {
                display: none; /* Hide table on small screens */
            }

            .student-grid {
                display: grid;
            }
            
            .tab-btn {
                padding: 12px 20px;
                font-size: 1em;
            }

            .dashboard h2 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>🏆 CodeTrack</h1>
            <p>University Coding Platform Dashboard</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('register')">📝 Register Profile</button>
            <button class="tab-btn" onclick="switchTab('dashboard')">📊 Dashboard</button>
        </div>

        <!-- Register Tab -->
        <div class="tab-content active" id="register">
            <div class="form-container">
                <h2 style="color: #333; margin-bottom: 30px; text-align: center; font-size: 2em;">Register Your Profile</h2>
                
                <form id="studentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label for="university">University *</label>
                            <input type="text" id="university" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="degree">Degree</label>
                            <select id="degree" onchange="updateYearOptions()">
                                <option value="">Select Degree</option>
                                <option value="B.Tech">B.Tech</option>
                                <option value="M.Tech">M.Tech</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group" id="yearGroup" style="display: none;">
                            <label for="year">Academic Year</label>
                            <select id="year">
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group" id="otherYearGroup" style="display: none;">
                            <label for="otherYear">Academic Year</label>
                            <select id="otherYear">
                                <option value="">Select Year</option>
                                <option value="1st Year">1st Year</option>
                                <option value="2nd Year">2nd Year</option>
                                <option value="3rd Year">3rd Year</option>
                                <option value="4th Year">4th Year</option>
                                <option value="Graduate">Graduate</option>
                            </select>
                        </div>

                    <div class="form-row">
                        <div class="form-group" style="grid-column: span 2;">
                            <label for="department">Department</label>
                            <input type="text" id="department" placeholder="e.g., Computer Science">
                        </div>
                    </div>

                    <h3 style="color: #333; margin: 30px 0 20px; text-align: center;">Coding Platform Profiles</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="codechef">CodeChef Username</label>
                            <input type="text" id="codechef" placeholder="Your CodeChef username">
                        </div>
                        <div class="form-group">
                            <label for="codechefProblems">CodeChef Problems Solved</label>
                            <input type="number" id="codechefProblems" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="codeforces">Codeforces Username</label>
                            <input type="text" id="codeforces" placeholder="Your Codeforces username">
                        </div>
                        <div class="form-group">
                            <label for="codeforcesProblems">Codeforces Problems Solved</label>
                            <input type="number" id="codeforcesProblems" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="leetcode">LeetCode Username</label>
                            <input type="text" id="leetcode" placeholder="Your LeetCode username">
                        </div>
                        <div class="form-group">
                            <label for="leetcodeProblems">LeetCode Problems Solved</label>
                            <input type="number" id="leetcodeProblems" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="codechefContests">CodeChef Contests Participated</label>
                            <input type="number" id="codechefContests" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="codeforcesContests">Codeforces Contests Participated</label>
                            <input type="number" id="codeforcesContests" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="leetcodeContests">LeetCode Contests Participated</label>
                        <input type="number" id="leetcodeContests" min="0" placeholder="0" style="max-width: 48.5%;">
                    </div>

                    <button type="submit" class="submit-btn" onclick="addStudent(); return false;">🚀 Add to Dashboard</button>
                </form>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content" id="dashboard">
            <div class="dashboard">
                <h2>🏆 Student Rankings</h2>
                
                <div class="stats-overview" id="statsOverview">
                    <div class="stat-card">
                        <div class="stat-number" id="totalStudents">0</div>
                        <div class="stat-label">Total Students</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalProblems">0</div>
                        <div class="stat-label">Problems Solved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalContests">0</div>
                        <div class="stat-label">Contests Participated</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avgScore">0</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                </div>

                <div class="view-toggle">
                    <button class="view-btn active" id="listViewBtn" onclick="switchView('list')">📋 List View</button>
                    <button class="view-btn" id="cardViewBtn" onclick="switchView('cards')">🎴 Card View</button>
                </div>

                <div class="filters">
                    <select class="filter-select" id="universityFilter">
                        <option value="">All Universities</option>
                    </select>
                    <select class="filter-select" id="yearFilter">
                        <option value="">All Years</option>
                    </select>
                    <select class="filter-select" id="sortBy">
                        <option value="total">Sort by Total Score</option>
                        <option value="problems">Sort by Problems Solved</option>
                        <option value="contests">Sort by Contests</option>
                    </select>
                </div>

                <div id="studentsContainer">
                    <div class="empty-state">
                        <h3>No students registered yet!</h3>
                        <p>Be the first to add your coding profile to the dashboard.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables to store the current state
        let currentView = 'list';
        let students = [];

        // Sample data for demonstration
        const sampleStudents = [
            {
                name: "Alex Johnson",
                university: "MIT",
                degree: "B.Tech",
                year: "3rd Year",
                department: "Computer Science",
                codechef: "alexj_codes",
                codechefProblems: 450,
                codechefContests: 25,
                codeforces: "alex_coder",
                codeforcesProblems: 380,
                codeforcesContests: 30,
                leetcode: "alexjohnson",
                leetcodeProblems: 520,
                leetcodeContests: 15
            },
            {
                name: "Sarah Chen",
                university: "Stanford",
                degree: "B.Tech",
                year: "4th Year",
                department: "Computer Science",
                codechef: "sarah_chen",
                codechefProblems: 520,
                codechefContests: 35,
                codeforces: "sarahc",
                codeforcesProblems: 420,
                codeforcesContests: 28,
                leetcode: "sarah_codes",
                leetcodeProblems: 610,
                leetcodeContests: 22
            },
            {
                name: "Mike Rodriguez",
                university: "UC Berkeley",
                degree: "M.Tech",
                year: "2nd Year",
                department: "Computer Science",
                codechef: "mike_rod",
                codechefProblems: 280,
                codechefContests: 18,
                codeforces: "mikeR",
                codeforcesProblems: 320,
                codeforcesContests: 20,
                leetcode: "mike_r",
                leetcodeProblems: 380,
                leetcodeContests: 12
            }
        ];

        // Load sample data on page load
        students = [...sampleStudents];

        // Function to switch between Register and Dashboard tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            const activeBtn = document.querySelector(`.tab-btn[onclick="switchTab('${tabName}')"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            const activeContent = document.getElementById(tabName);
            if (activeContent) {
                activeContent.classList.add('active');
            }
            
            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }
        
        // Dynamically update the year dropdown based on degree selection
        function updateYearOptions() {
            const degreeSelect = document.getElementById('degree');
            const yearGroup = document.getElementById('yearGroup');
            const yearSelect = document.getElementById('year');
            const otherYearGroup = document.getElementById('otherYearGroup');

            const degreeValue = degreeSelect.value;
            yearGroup.style.display = 'none';
            otherYearGroup.style.display = 'none';

            // Clear previous options
            yearSelect.innerHTML = '';
            
            let options = [];
            if (degreeValue === 'B.Tech') {
                options = ['1st Year', '2nd Year', '3rd Year', '4th Year'];
            } else if (degreeValue === 'M.Tech') {
                options = ['1st Year', '2nd Year'];
            } else if (degreeValue === 'Other') {
                otherYearGroup.style.display = 'block';
                return;
            }

            if (options.length > 0) {
                yearGroup.style.display = 'block';
                const defaultOption = document.createElement('option');
                defaultOption.value = "";
                defaultOption.textContent = "Select Year";
                yearSelect.appendChild(defaultOption);

                options.forEach(optionText => {
                    const option = document.createElement('option');
                    option.value = optionText;
                    option.textContent = optionText;
                    yearSelect.appendChild(option);
                });
            }
        }

        // Helper function to calculate a total score for ranking
        function calculateTotalScore(student) {
            const problemsScore = (student.codechefProblems || 0) + (student.codeforcesProblems || 0) + (student.leetcodeProblems || 0);
            const contestsScore = ((student.codechefContests || 0) + (student.codeforcesContests || 0) + (student.leetcodeContests || 0)) * 10;
            return problemsScore + contestsScore;
        }

        // Helper function to get total problems solved
        function getTotalProblems(student) {
            return (student.codechefProblems || 0) + (student.codeforcesProblems || 0) + (student.leetcodeProblems || 0);
        }

        // Helper function to get total contests participated
        function getTotalContests(student) {
            return (student.codechefContests || 0) + (student.codeforcesContests || 0) + (student.leetcodeContests || 0);
        }

        // Helper function to determine CSS class for rank
        function getRankClass(rank) {
            if (rank === 1) return 'rank-1';
            if (rank === 2) return 'rank-2';
            if (rank === 3) return 'rank-3';
            return 'rank-other';
        }

        // Function to update the summary stats
        function updateStats() {
            const totalStudents = students.length;
            const totalProblems = students.reduce((sum, student) => sum + getTotalProblems(student), 0);
            const totalContests = students.reduce((sum, student) => sum + getTotalContests(student), 0);
            const avgScore = totalStudents > 0 ? Math.round(students.reduce((sum, student) => sum + calculateTotalScore(student), 0) / totalStudents) : 0;

            document.getElementById('totalStudents').textContent = totalStudents;
            document.getElementById('totalProblems').textContent = totalProblems;
            document.getElementById('totalContests').textContent = totalContests;
            document.getElementById('avgScore').textContent = avgScore;
        }

        // Function to update the university filter dropdown
        function updateUniversityFilter() {
            const universities = [...new Set(students.map(student => student.university))].sort();
            const universityFilter = document.getElementById('universityFilter');
            
            universityFilter.innerHTML = '<option value="">All Universities</option>';
            
            universities.forEach(uni => {
                const option = document.createElement('option');
                option.value = uni;
                option.textContent = uni;
                universityFilter.appendChild(option);
            });
        }
        
        // Function to update the year filter dropdown
        function updateYearFilter() {
             const years = [...new Set(students.map(student => student.year))].sort();
             const yearFilter = document.getElementById('yearFilter');
            
            yearFilter.innerHTML = '<option value="">All Years</option>';
            
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearFilter.appendChild(option);
            });
        }

        // Function to filter and sort students based on user selections
        function filterAndSortStudents() {
            const universityFilter = document.getElementById('universityFilter').value;
            const yearFilter = document.getElementById('yearFilter').value;
            const sortBy = document.getElementById('sortBy').value;

            let filteredStudents = students.filter(student => {
                const universityMatch = !universityFilter || student.university === universityFilter;
                const yearMatch = !yearFilter || student.year === yearFilter;
                return universityMatch && yearMatch;
            });

            // Sort students
            filteredStudents.sort((a, b) => {
                switch (sortBy) {
                    case 'problems':
                        return getTotalProblems(b) - getTotalProblems(a);
                    case 'contests':
                        return getTotalContests(b) - getTotalContests(a);
                    case 'total':
                    default:
                        return calculateTotalScore(b) - calculateTotalScore(a);
                }
            });

            return filteredStudents;
        }

        // The main function to update the dashboard view
        function updateDashboard() {
            const filteredStudents = filterAndSortStudents();
            const container = document.getElementById('studentsContainer');
            
            if (filteredStudents.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No students found!</h3>
                        <p>Try adjusting your filters or add more student profiles.</p>
                    </div>
                `;
                return;
            }

            if (currentView === 'list') {
                // List/Table View
                const tableHTML = `
                    <div class="students-table">
                        <div class="table-header">
                            <div class="table-cell">Rank</div>
                            <div class="table-cell name-cell">Student</div>
                            <div class="table-cell">Year/Dept</div>
                            <div class="table-cell">Total Problems</div>
                            <div class="table-cell">CodeChef</div>
                            <div class="table-cell">Codeforces</div>
                            <div class="table-cell">LeetCode</div>
                            <div class="table-cell">Total Score</div>
                        </div>
                        <div style="display: table-row-group;">
                            ${filteredStudents.map((student, index) => {
                                const rank = index + 1;
                                const totalScore = calculateTotalScore(student);
                                const totalProblems = getTotalProblems(student);
                                
                                return `
                                    <div class="table-row">
                                        <div class="table-cell rank-cell ${getRankClass(rank)}">
                                            ${rank === 1 ? '🥇' : rank === 2 ? '🥈' : rank === 3 ? '🥉' : '#' + rank}
                                        </div>
                                        <div class="table-cell name-cell">
                                            <div class="student-name">${student.name}</div>
                                            <div class="student-uni">${student.university}</div>
                                        </div>
                                        <div class="table-cell">
                                            <div>${student.year}</div>
                                            <div style="font-size: 0.8em; color: #666;">${student.department}</div>
                                        </div>
                                        <div class="table-cell" style="font-weight: 700; color: #333;">${totalProblems}</div>
                                        <div class="table-cell">
                                            <div class="platform-score codechef">${student.codechefProblems || 0}</div>
                                        </div>
                                        <div class="table-cell">
                                            <div class="platform-score codeforces">${student.codeforcesProblems || 0}</div>
                                        </div>
                                        <div class="table-cell">
                                            <div class="platform-score leetcode">${student.leetcodeProblems || 0}</div>
                                        </div>
                                        <div class="table-cell total-score-cell">${totalScore}</div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
                container.innerHTML = tableHTML;
            } else {
                // Card View (Original)
                const studentsHTML = filteredStudents.map((student, index) => {
                    const rank = index + 1;
                    const totalScore = calculateTotalScore(student);
                    const totalProblems = getTotalProblems(student);
                    const totalContests = getTotalContests(student);
                    
                    return `
                        <div class="student-card ${getRankClass(rank)}">
                            <div class="student-header">
                                <div class="student-name">${student.name}</div>
                                <div class="rank-badge ${getRankClass(rank)}">
                                    ${rank === 1 ? '🥇' : rank === 2 ? '🥈' : rank === 3 ? '🥉' : '#' + rank}
                                </div>
                            </div>
                            
                            <div class="student-info">
                                <strong>${student.university}</strong> • ${student.year} • ${student.department}
                            </div>
                            
                            <div class="platforms">
                                <div class="platform codechef">
                                    <h4>CodeChef</h4>
                                    <div class="score">${student.codechefProblems || 0}</div>
                                    <small>${student.codechefContests || 0} contests</small>
                                </div>
                                <div class="platform codeforces">
                                    <h4>Codeforces</h4>
                                    <div class="score">${student.codeforcesProblems || 0}</div>
                                    <small>${student.codeforcesContests || 0} contests</small>
                                </div>
                                <div class="platform leetcode">
                                    <h4>LeetCode</h4>
                                    <div class="score">${student.leetcodeProblems || 0}</div>
                                    <small>${student.leetcodeContests || 0} contests</small>
                                </div>
                            </div>
                            
                            <div class="total-score">
                                Total Score: ${totalScore} | Problems: ${totalProblems} | Contests: ${totalContests}
                            </div>
                        </div>
                    `;
                }).join('');

                container.innerHTML = `<div class="student-grid">${studentsHTML}</div>`;
            }
            
            updateStats();
            updateUniversityFilter();
            updateYearFilter();
        }

        // Add student function
        function addStudent() {
            // Get form values
            const name = document.getElementById('name').value.trim();
            const university = document.getElementById('university').value.trim();
            
            // Check required fields
            if (!name || !university) {
                console.error('Please fill in at least Name and University fields!');
                return;
            }
            
            const degree = document.getElementById('degree').value;
            let year = '';
            if (degree === 'Other') {
                year = document.getElementById('otherYear').value || 'Not specified';
            } else {
                year = document.getElementById('year').value || 'Not specified';
            }
            
            const formData = {
                name: name,
                university: university,
                degree: degree || 'Not specified',
                year: year,
                department: document.getElementById('department').value || 'Not specified',
                codechef: document.getElementById('codechef').value || '',
                codechefProblems: parseInt(document.getElementById('codechefProblems').value) || 0,
                codechefContests: parseInt(document.getElementById('codechefContests').value) || 0,
                codeforces: document.getElementById('codeforces').value || '',
                codeforcesProblems: parseInt(document.getElementById('codeforcesProblems').value) || 0,
                codeforcesContests: parseInt(document.getElementById('codeforcesContests').value) || 0,
                leetcode: document.getElementById('leetcode').value || '',
                leetcodeProblems: parseInt(document.getElementById('leetcodeProblems').value) || 0,
                leetcodeContests: parseInt(document.getElementById('leetcodeContests').value) || 0
            };
            
            students.push(formData);
            
            // Reset form
            document.getElementById('studentForm').reset();
            
            // Update dashboard and switch tab
            updateDashboard();
            switchTab('dashboard');
        }

        // Event listeners for filters
        document.getElementById('universityFilter').addEventListener('change', updateDashboard);
        document.getElementById('yearFilter').addEventListener('change', updateDashboard);
        document.getElementById('sortBy').addEventListener('change', updateDashboard);

        // Initial function calls on page load
        window.onload = function() {
            updateDashboard();
            updateUniversityFilter();
            updateYearFilter();
        };
    </script>
</body>
</html>
